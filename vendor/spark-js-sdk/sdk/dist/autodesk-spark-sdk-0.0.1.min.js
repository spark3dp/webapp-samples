/*! autodesk-spark-sdk v0.0.1 | (c) Autodesk, Inc. | 2015-05-06 | Apache 2.0 */
!function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void j(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=c.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&k(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&"object"==typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},"undefined"!=typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);var ADSKSpark=ADSKSpark||{};ADSKSpark.Constants=function(){"use strict";return{API_HOST_PROD:"https://api.spark.autodesk.com/api/v1",API_HOST_SANDBOX:"https://sandbox.spark.autodesk.com/api/v1",EXPORT_TASK_TYPE:"export",ERROR_TASK_STATUS:"error",RUNNING_TASK_STATUS:"running"}}();var ADSKSpark=ADSKSpark||{};ADSKSpark.Helpers=function(){"use strict";var a={popupWindow:function(a,b,c,d){var e=screen.width/2-c/2,f=screen.height/3-d/3;return window.open(a,b,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+c+", height="+d+", top="+f+", left="+e)},transformToAssocArray:function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[e[0]]=e[1]}return b},extractParamsFromURL:function(){var b=window.location.search.substr(1),c=null!=b&&""!=b?a.transformToAssocArray(b):[];return c}};return a}();var ADSKSpark=ADSKSpark||{};ADSKSpark.Request=function(a,b,c){c=c||{};var d=function(d,e,f){e=e||{};var g="";if(f&&"GET"===d){var h=0;for(var i in f)f.hasOwnProperty(i)&&(h++&&(g+="&"),g+=encodeURIComponent(i)+"="+encodeURIComponent(f[i]));a+="?"+g,g=""}else g=f;var j=new Promise(function(f,h){var i=new XMLHttpRequest;i.open(d,a);for(var j in e)e.hasOwnProperty(j)&&i.setRequestHeader(j,e[j]);b&&!e.hasOwnProperty("Authorization")&&i.setRequestHeader("Authorization",b),i.onload=function(){if(200===i.status||201===i.status||202===i.status||204===i.status){var a;a=204!=i.status?c.notJsonResponse?i.responseText:JSON.parse(i.responseText):!0,f(a)}else h(new Error(i.status+" "+i.responseText))},i.onerror=function(a){h(new Error(404))},i.send(g)});return j};return{get:function(a,b){return d("GET",a,b)},post:function(a,b){return d("POST",a,b)},put:function(a,b){return d("PUT",a,b)},"delete":function(a,b){return d("DELETE",a,b)}}};var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Paginated=function(a){this.parse(a)},ADSKSpark.Paginated.prototype=Object.create(Array.prototype),ADSKSpark.Paginated.prototype.constructor=ADSKSpark.Paginated,ADSKSpark.Paginated.prototype.hasPrev=function(){return this.data&&!!this.data._link_prev},ADSKSpark.Paginated.prototype.prev=function(){if(this.data){var b=this.data._link_prev,c=this;if(b)return a.authorizedApiRequest(b).get().then(function(a){return c.parse(a),c})}return Promise.reject(new Error("no prev link"))},ADSKSpark.Paginated.prototype.hasNext=function(){return this.data&&!!this.data._link_next},ADSKSpark.Paginated.prototype.next=function(){if(this.data){var b=this.data._link_next,c=this;if(b)return a.authorizedApiRequest(b).get().then(function(a){return c.parse(a),c})}return Promise.reject(new Error("no next link"))},ADSKSpark.Paginated.prototype.parse=function(a){this.splice(0,this.length),this.data=a}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client={},b=ADSKSpark.Helpers,c="spark-guest-token",d="spark-access-token",e="",f="",g="",h="",i="",j=function(){return ADSKSpark.Request(g).get().then(function(a){var b=new Date,d=b.getTime();return a.expires_at=d+1e3*parseInt(a.expires_in),localStorage.setItem(c,JSON.stringify(a)),a.access_token})};a.initialize=function(a,b,c,d){e=a,g=b,h=c,f=d},a.getLoginRedirectUrl=function(){return f+"/oauth/authorize?response_type=code&client_id="+e},a.logout=function(){localStorage.removeItem(c),localStorage.removeItem(d)},a.completeLogin=function(a){return ADSKSpark.Request(h).get(void 0,{code:a}).then(function(a){if(a&&a.expires_in&&a.access_token){var b=Date.now();return a.expires_at=b+1e3*parseInt(a.expires_in),localStorage.setItem(d,JSON.stringify(a)),a.access_token}return Promise.reject(new Error(a))})},a.isAccessTokenValid=function(){var a=JSON.parse(localStorage.getItem(d)),b=Date.now();return!!(a&&a.expires_at&&a.expires_at>b)},a.getAccessTokenObject=function(){var a=JSON.parse(localStorage.getItem(d));return a&&a.access_token?a:null},a.getAccessToken=function(){var a=JSON.parse(localStorage.getItem(d));return a&&a.access_token?a.access_token:null},a.getGuestToken=function(){var a=JSON.parse(localStorage.getItem(c)),b=Date.now();return a&&a.expires_at&&a.expires_at>b?Promise.resolve(a.access_token):j()},a.authorizedApiRequest=function(b){var c;return i=a.getAccessToken(),i&&(c="Bearer "+i),ADSKSpark.Request(f+b,c)},a.openLoginWindow=function(){b.popupWindow(a.getLoginRedirectUrl(),"spark",350,600)}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Jobs=function(a){ADSKSpark.Paginated.call(this,a)},ADSKSpark.Jobs.prototype=Object.create(ADSKSpark.Paginated.prototype),ADSKSpark.Jobs.prototype.constructor=ADSKSpark.Jobs,ADSKSpark.Jobs.get=function(b,c){return a.authorizedApiRequest("/print/jobs").get(b,c).then(function(a){return new ADSKSpark.Jobs(a)})},ADSKSpark.Jobs.prototype.parse=function(a){if(ADSKSpark.Paginated.prototype.parse.call(this,a),a){var b=a.jobs||a.printer_jobs;if(Array.isArray(b)){var c=this;b.forEach(function(b){b.printer_id||(b.printer_id=a.printer_id),b.member_id||(b.member_id=a.member_id),c.push(new ADSKSpark.Job(b))})}}},ADSKSpark.Job=function(a){this.id=a.job_id,this.printerId=a.printer_id,this.data=a,this.status=null},ADSKSpark.Job.prototype={constructor:ADSKSpark.Job,getStatus:function(){var b=this;return a.authorizedApiRequest("/print/jobs/"+this.id).get().then(function(a){return b.status=a,a})["catch"](function(a){b.status=null})},setCallback:function(b){return a.authorizedApiRequest("/print/jobs/"+this.id+"/register").post(null,{callback_url:b})}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Printers=function(a){ADSKSpark.Paginated.call(this,a)},ADSKSpark.Printers.prototype=Object.create(ADSKSpark.Paginated.prototype),ADSKSpark.Printers.prototype.constructor=ADSKSpark.Printers,ADSKSpark.Printers.get=function(b){return a.authorizedApiRequest("/print/printers").get(null,b).then(function(a){return new ADSKSpark.Printers(a)})},ADSKSpark.Printers.prototype.parse=function(a){if(ADSKSpark.Paginated.prototype.parse.call(this,a),a){var b=a.printers;if(Array.isArray(b)){var c=this;b.forEach(function(a){c.push(new ADSKSpark.Printer(a))})}}},ADSKSpark.PrinterMembers=function(a){ADSKSpark.Paginated.call(this,a)},ADSKSpark.PrinterMembers.prototype=Object.create(ADSKSpark.Paginated.prototype),ADSKSpark.PrinterMembers.prototype.constructor=ADSKSpark.PrinterMembers,ADSKSpark.PrinterMembers.prototype.parse=function(a){if(ADSKSpark.Paginated.prototype.parse.call(this,a),a){var b=a.members;if(Array.isArray(b)){var c=this;b.forEach(function(a){c.push(a)})}}},ADSKSpark.Printer=function(a){this.id=a.printer_id||a.id,this.name=a.printer_name||a.name,this.firmware=a.firmware,this.typeId=a.type_id,this.isPrimary=a.is_primary,this.data=a,this.status=null},ADSKSpark.Printer.register=function(b,c,d){return a.authorizedApiRequest("/print/printers/register").post(null,{printer_name:b,registration_code:c,secondary_member_id:d}).then(function(a){return a.registered?ADSKSpark.Printer.getById(a.printer_id):Promise.reject(new Error("not registered"))})},ADSKSpark.Printer.getById=function(b){return a.authorizedApiRequest("/print/printers/"+b).get().then(function(a){return new ADSKSpark.Printer(a)})},ADSKSpark.Printer.prototype={constructor:ADSKSpark.Printer,getStatus:function(){var b=this;return a.authorizedApiRequest("/print/printers/"+this.id).get().then(function(a){return b.status=a,a})["catch"](function(a){b.status=null})},isOnline:function(){return this.status||"Offline"!==this.data.printer_last_health},isPrinting:function(){var a=(((this.status||{}).last_reported_state||{}).data||{}).state;return/^(?:Exposing|Printing|Printing Layer|Separating)$/.test(a)},pause:function(a){var b=a instanceof ADSKSpark.Job?a.id:a;return this.sendCommand("pause",{job_id:b})},resume:function(a){var b=a instanceof ADSKSpark.Job?a.id:a;return this.sendCommand("resume",{job_id:b})},cancel:function(a){var b=a instanceof ADSKSpark.Job?a.id:a;return this.sendCommand("cancel",{job_id:b})},reset:function(){return this.sendCommand("reset")},calibrate:function(){return this.sendCommand("calibrate")},firmwareUpgrade:function(a){return this.sendCommand("firmware_upgrade",{package_url:a})},log:function(){return this.sendCommand("log")},home:function(){return this.sendCommand("home")},park:function(){return this.sendCommand("park")},sendCommandAndWait:function(a,b,c){this.sendCommand(a,b).then(function(a){return this.waitForCommand(a.task_id,c)}).then(function(a){return a})},sendCommand:function(b,c){return c=c||{},c.command=b,a.authorizedApiRequest("/print/printers/"+this.id+"/command").post(null,c).then(function(a){return a})},waitForCommand:function(b,c){c=c||{};var d=c.freq||1e3,e=c.timeout||1e4,f=+new Date,g="/print/printers/command/"+b;return new Promise(function(b,h){var i=setInterval(function(){a.authorizedApiRequest(g).get().then(function(a){var d=((a||{}).data||{}).is_error;if(d)clearInterval(i),h(new Error(a.error_message));else if(c.progressHandler&&c.progressHandler(a),a&&1<=a.progress)clearInterval(i),b(a);else{var g=+new Date;g-f>=e&&(clearInterval(i),h(new Error("timeout")))}})["catch"](function(a){clearInterval(i),h(a)})},d)})},setMemberRole:function(b,c,d){return this.isPrimary?a.authorizedApiRequest("/print/printers/"+this.id+"/member_role").post(null,{secondary_member_id:b,is_printer_scoped:c,is_job_scoped:d}):Promise.reject(new Error("not printer owner"))},generateRegistrationCode:function(b){return this.isPrimary?a.authorizedApiRequest("/print/printers/"+this.id+"/secondary_registration").post(null,{secondary_member_email:b}):Promise.reject(new Error("not printer owner"))},getMembers:function(b){return a.authorizedApiRequest("/print/printers/"+this.id+"/members").get(null,b).then(function(a){return new ADSKSpark.PrinterMembers(a)})},unregister:function(b){var c;return b&&(c={secondary_member_id:b}),a.authorizedApiRequest("/print/printers/"+this.id)["delete"](null,c)},getJobs:function(b){return a.authorizedApiRequest("/print/printers/"+this.id+"/jobs").get(null,b).then(function(a){return new ADSKSpark.Jobs(a)})},createJob:function(b,c,d,e){return a.authorizedApiRequest("/print/printers/"+this.id+"/jobs").post(null,{printable_id:b,printable_url:c,settings:d,callback_url:e})},startJob:function(b){var c=b instanceof ADSKSpark.Job?b.id:b;return a.authorizedApiRequest("/print/printers/"+this.id+"/jobs").put(null,{job_id:c})}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client,b=0,c=function(c,d,e,f){++b,d=d||"Mesh_"+b,f=f||[[1,0,0,0],[0,1,0,0],[0,0,1,0]];var g={file_id:c,name:d,transform:f,generate_visual:!!e},h={"Content-Type":"application/json"};return a.authorizedApiRequest("/geom/meshes/import").post(h,JSON.stringify(g))},d=function(b,c){var d=new FormData;return d.append(b.name,b),a.authorizedApiRequest("/files/upload").post(null,d)};ADSKSpark.MeshAPI={importMesh:function(a,b,d,e,f){var g=new ADSKSpark.TaskWaiter(f);return c(a,b,d,e).then(g.wait)},uploadFile:function(a,b){return d(a,b)},transformMesh:function(b,c){var d={id:b,transform:c};return a.authorizedApiRequest("/geom/meshes/transform").post(null,d)},analyzeMesh:function(b,c){var d={id:b},e=new ADSKSpark.TaskWaiter(c);return a.authorizedApiRequest("/geom/meshes/analyze").post(null,d).then(e.wait)},generateVisual:function(b,c){var d={id:b},e=new ADSKSpark.TaskWaiter(c);return a.authorizedApiRequest("/geom/meshes/generateVisual").post(null,d).then(e.wait)}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.PrintDB={getPrinterType:function(b){return a.authorizedApiRequest("/printDB/printerTypes/"+b).get()},getPrinterTypes:function(){return a.authorizedApiRequest("/printDB/printerTypes").get().then(function(a){return a.printer_types})},getMaterial:function(a){},getProfile:function(a){}}}();var ADSKSpark=ADSKSpark||{};ADSKSpark.PrintLayout=function(a,b){function c(a){return j._lock?Promise.reject("Attempted operation on locked PrintLayout"):Promise.resolve(a)}function d(a){m=!1,o=null,h=null;for(var b=0;b<newMeshes.length;++b)n[b].setAttributes({reposition:!0,reorient:!0,support:!0});return Promise.resolve(a)}function e(a){return h="Print Layout Error: "+a,console.log(h),Promise.reject(h)}function f(a){return new Promise(function(b,c){a._supported?b(a):(a._supported=!0,b(a))})}var g,h,i=ADSKSpark.TraiAPI,j=this,k=!1,l=b||"Print Job",m=!1,n=[],o=null,p=null,q=a;this.setName=function(a){return k?!1:(l=a,!0)},this.getName=function(){return l},this.getId=function(){return o?o.id:null},this.addModel=function(a){function b(a){var b=new ADSKSpark.PrintModel(a,getNameFromPath(a));return n.push(b),b.importMesh()}return c(a).then(d).then(b)["catch"](e)},this.addSparkModel=function(a){function b(a){return n.push(a),a.importMesh()}return c(a).then(d).then(b)["catch"](e)},this.removeModel=function(a){function b(a){n.splice(a,1);return j}return c(a).then(d).then(b)},this.getModels=function(){return n.slice()},this.transformModel=function(a,b){function e(a){var b=a[0],c=a[1],d=n[b];return d.transform(c)}return c([a,b]).then(d).then(e)},this.prepare=function(){function a(){if(!j._trayData){var a={},b=n.map(function(b){var c=b.getId();return a[c]=b.getAttributes(),c});return i.createTray(q.id,g?g:q.profile_id,b,a).then(function(a){return j._prepared=!1,j._trayData=a,a})}Promise.resolve(j._trayData)}function b(){if(!j._prepared){({id:j.getId(),generate_visual:!0});return i.prepareTray(j.getId(),!0).then(function(a){for(var b=a.meshes,c=0;c<b.length;++c)n[c].updateMesh(b[c]);return j._trayData=a,j._prepared=!0,a})}Promise.resolve(j._trayData)}return c().then(a).then(b)},this.getVisuals=function(){},this.getSupportFiles=function(){function a(a){return n.map(function(a){return a.getSupport()})}return this.prepare().then(f).then(a)},this.getSupportVisuals=function(){function a(a){return n.map(function(a){return a.getSupportVisual()})}return this.prepare().then(f).then(a)},this.getPrintable=function(){function a(a){return new Promise(function(b,c){p?b(p):(this._printable=response.file_id,b(a._printable))})}return p?Promise.resolve(p):this.prepare().then(a)},this.downloadPrintable=function(a){},this.getSupport=function(){},this.getSupportVisual=function(){},this.setLock=function(a){return a&&this.getPrintable()?(k=a,!0):!1},this.getLock=function(){return k},this.setProfile=function(a){d(),g=a},this.setPrinterType=function(a){d(),q=a}};var ADSKSpark=ADSKSpark||{};ADSKSpark.PrintModel=function(a,b,c){function d(a){return j=a,l++,a}function e(a){return i=a,a}var f=(ADSKSpark.Client,ADSKSpark.MeshAPI),g=b,h=c,i=null,j=null,k=null,l=0,m={reposition:!0,reorient:!0,support:!0};this.importMesh=function(a){return k||(k=f.importMesh(h.file_id,g,transform,a).then(d)["catch"](e)),k},this.getName=function(){return g},this.getId=function(){return j?j.id:null},this.setAttributes=function(a){void 0!==a.support&&(m.support=!!a.support),void 0!==a.reposition&&(m.reposition=!!a.reposition),void 0!==a.reorient&&(m.reorient=!!a.reorient)},this.getAttributes=function(){return m},this.transform=function(a,b){return f.transformMesh(this.getId(),a,b).then(d)},this.analyze=function(a){return j&&j.analyzed?Promise.resolve(j):f.analyzeMesh(this.getId(),transform,a).then(d)},this.repair=function(a,b){},this.getVisualId=function(a){function b(a){return Promise.resolve(j.visual_file_id)}return j&&j.visual_file_id?b():f.generateVisual(this.getId(),a).then(d).then(b)},this.getSerialNumber=function(){return l},this.updateMesh=function(a){d(a)}};var ADSKSpark=ADSKSpark||{};ADSKSpark.TaskWaiter=function(a){var b,c,d=ADSKSpark.Client,e=this;this._checkTaskResponse=function(b){if(console.log("Task status: ",b.status,"progress:",b.progress),"done"===b.status){var d=b.result;return d}return"error"===b.status?Promise.reject(b):(a&&a(b.progress),console.log("Delay task"),new Promise(function(a){setTimeout(function(){a()},c)}).then(e._pollTask))},this._pollTask=function(){return console.log("Poll task"),d.authorizedApiRequest("/print/tasks/"+b).get().then(e._checkTaskResponse)},this.wait=function(a,d){return d=d||100,10>d&&(d=10),b=a.id,c=d,e._pollTask()}};var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.TrayAPI={createTray:function(b,c,d,e,f,g){var h=new ADSKSpark.TaskWaiter(g),i={printer_type_id:b,profile_id:c,mesh_ids:d};return e&&(i.mesh_attrs=e),f&&(i.default_material_id=defaulMaterialId),a.authorizedApiRequest("/print/trays").post(null,i).then(h.wait)},prepareTray:function(b,c,d){var e=new ADSKSpark.TaskWaiter(d),f={id:b,generate_visual:!!c};return a.authorizedApiRequest("/print/trays/prepare").post(null,f).then(e.wait)}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Assets={getAsset:function(b){return a.authorizedApiRequest("/assets/"+b).get().then(function(a){return a})["catch"](function(a){return a})},getMyAssets:function(b){if(a.isAccessTokenValid()){var c=a.getAccessTokenObject(),d=c.spark_member_id;return a.authorizedApiRequest("/members/"+d+"/assets").get(null,b).then(function(a){return a})["catch"](function(a){return a})}return Promise.reject(new Error("Access token is invalid"))},createAsset:function(b){var c=Object.keys(b).map(function(a){return encodeURIComponent(a)+"="+encodeURIComponent(b[a])}).join("&"),d={"Content-type":"application/x-www-form-urlencoded"};return a.authorizedApiRequest("/assets").post(d,c).then(function(a){return a})["catch"](function(a){return a})},updateAsset:function(b){if(b.assetId&&!isNaN(b.assetId)){var c=Object.keys(b).map(function(a){return"assetId"!==a?encodeURIComponent(a)+"="+encodeURIComponent(b[a]):void 0}).join("&");return c=c.substring(0,c.length-1),a.authorizedApiRequest("/assets/"+b.assetId).put(null,c).then(function(a){return a})["catch"](function(a){return a})}return Promise.reject(new Error("Proper assetId was not supplied"))},removeAsset:function(b){return a.authorizedApiRequest("/assets/"+b)["delete"]().then(function(a){return a})["catch"](function(a){return a})},retrieveAssetThumbnails:function(b){return isNaN(b)?Promise.reject(new Error("Proper assetId was not supplied")):a.authorizedApiRequest("/assets/"+b+"/thumbnails").get().then(function(a){var c={assetId:b,thumbnails:a.thumbnails};return c})["catch"](function(a){return a})},retrieveAssetSources:function(b){return isNaN(b)?Promise.reject(new Error("Proper assetId was not supplied")):a.authorizedApiRequest("/assets/"+b+"/sources").get().then(function(a){var c={assetId:b,sources:a.sources};return c})["catch"](function(a){return a})},createAssetThumbnails:function(b,c){if(isNaN(b))return Promise.reject(new Error("Proper assetId was not supplied"));for(var d=[],e=0;e<c.length;e++){var f={id:c[e].id,caption:c[e].caption?c[e].caption:"",description:c[e].description?c[e].description:"",is_primary:c[e].is_primary?c[e].is_primary:!1};d.push(f)}var g="thumbnails="+JSON.stringify(d),h={"Content-type":"application/x-www-form-urlencoded"};return a.authorizedApiRequest("/assets/"+b+"/thumbnails").post(h,g).then(function(a){return a})["catch"](function(a){return a})},createAssetSources:function(b,c){if(isNaN(b))return Promise.reject(new Error("Proper assetId was not supplied"));var d="file_ids="+c,e={"Content-type":"application/x-www-form-urlencoded"};return a.authorizedApiRequest("/assets/"+b+"/sources").post(e,d).then(function(a){return a})["catch"](function(a){return a})},deleteAssetSources:function(b,c){if(isNaN(b))return Promise.reject(new Error("Proper assetId was not supplied"));var d="?file_ids="+c;return a.authorizedApiRequest("/assets/"+b+"/sources"+d)["delete"]().then(function(a){return a})["catch"](function(a){return a})},deleteAssetThumbnails:function(b,c){if(isNaN(b))return Promise.reject(new Error("Proper assetId was not supplied"));var d="?thumbnail_ids="+c;return a.authorizedApiRequest("/assets/"+b+"/thumbnails"+d)["delete"]().then(function(a){return a})["catch"](function(a){return a})}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Files={getFileDetails:function(b){return a.authorizedApiRequest("/files/"+b).get().then(function(a){return a})["catch"](function(a){return a})},uploadFile:function(b){var c=new FormData;c.append("file",b.file);var d=b.unzip?b.unzip:!1;return c.append("unzip",d),b["public"]&&c.append("public",b["public"]),a.authorizedApiRequest("/files/upload").post(null,c).then(function(a){return a})["catch"](function(a){return a})}}}();var ADSKSpark=ADSKSpark||{};!function(){var a=ADSKSpark.Client;ADSKSpark.Members={getMemberById:function(b){return a.authorizedApiRequest("/members/"+b).get().then(function(a){return a})["catch"](function(a){return a})},getMyProfile:function(){if(a.isAccessTokenValid()){var b=a.getAccessTokenObject(),c=b.spark_member_id;return ADSKSpark.Members.getMemberById(c)}return Promise.reject(new Error("Access token is invalid"))}}}();